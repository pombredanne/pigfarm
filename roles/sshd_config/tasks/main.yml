---
- name: upload sshd configuration
  template:
    src: sshd_config.j2
    dest: /etc/ssh/sshd_config
    mode: 0600
    owner: root
    group: root
  notify: restart sshd
  tags:
    - base
    - net

- name: create sftp user and shared folder
  user:
    name: sftp
    home: /home/shared/sftp/
    createhome: yes
    password: "{{ sftp_server_pass }}"
    shell: /usr/sbin/nologin
    state: present
  when: "{{ feature_sets[ansible_hostname]['sftp_server'] | default(false)}}"
