{% for socket in apache2_base_https_sockets %}
<VirtualHost {{ socket.host }}:{{ socket.port }}>

    ServerName repository.{{ hypervisor }}.vespian.net
    ServerAlias repo.{{ hypervisor }}.vespian.net

    # SSL
    SSLEngine on
    SSLProtocol all -SSLv2
    SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5
    SSLCertificateFile /etc/httpd/ssl/peppa.{{ hypervisor }}.vespian.net.pem
    SSLCertificateKeyFile /etc/httpd/ssl/peppa.{{ hypervisor }}.vespian.net.key

    # Autoindex options:
    IndexOptions +FancyIndexing

    # Logging
    LogLevel debug
    ErrorLog logs/repository.error.log
    CustomLog logs/repository.access.log combined_time

    DocumentRoot /var/www/repository/

    <Directory "/var/www/repository/">
        Options +Indexes -FollowSymLinks
        Require all granted
    </Directory>

</VirtualHost>
{% endfor %}
